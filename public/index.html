<!DOCTYPE html>
<html lang="en" dir="ltr" ng-app="myApp">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="stylesheets/style.css" media="screen" />

<script src='https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js'></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.6.1/angular-animate.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.6.1/angular-sanitize.js"></script>
<script src="./angular/crud.controller.js"></script>
<script src='/script/bootstrap/ui-bootstrap-tpls.js'></script>
<script src="/script/file-upload/ng-file-upload.min.js"></script>
<script src="/script/file-upload/ng-file-upload-shim.min.js"></script>
<script src="/script/xlsx/xlsx.core.min.js"></script>

<head>
  <meta charset="utf-8">
  <title>Vin Decoder</title>
  <div class="header">
    <label>Vin Decoder</label>
  </div>
</head>

<body>
  <div ng-controller="crudController as crud">
    <div >
      <div class="column">
        <label>Insert Vehicle</label>
        <form ng-submit="crud.insertVehicle()">
          <div ng-class="{'has-error' : !crud.insertedYear}">
            <label>year</label>
            <input type="number" ng-model="crud.insertedYear" class="form-control input-sm"
             uib-tooltip="must enter something into this field"
             tooltip-placement="top"
             tooltip-trigger="'mouseenter'"
             tooltip-enable="!crud.insertedYear">
          </div>
          <div ng-class="{'has-error' : !crud.insertedMake}">
            <label>make</label>
            <input type="text" ng-model="crud.insertedMake" class="form-control input-sm"
             uib-tooltip="must enter something into this field"
             tooltip-placement="top"
             tooltip-trigger="'mouseenter'"
             tooltip-enable="!crud.insertedMake">
          </div>
          <div>
            <label>harnessTypeOne</label>
            <input type="number" ng-model="crud.insertedHarnessTypeOne" class="form-control input-sm">
          </div>
          <div>
            <label>harnessTypeTwo</label>
            <input type="number" ng-model="crud.insertedHarnessTypeTwo" class="form-control input-sm">
          </div>
          <div>
            <br>
            <button type="submit" class="btn btn-primary">Submit</button>
          </div>
          <br>
          <div uib-alert dismiss-on-timeout="4000"
               ng-repeat="alert in crud.alerts"
               ng-class="'alert-' + (alert.type || 'warning')"
               close="crud.closeAlert($index)"
               >{{alert.msg}}</div>
        </form>
      </div>
      <div class="column">
        <form ng-submit="crud.fileUpload()">
          <label>upload .XLSX spreadsheet</label>
          <br><br>
          <label class="btn btn-default btn-file">
            Upload file
            <input onchange="$('#upload-file-info').html(this.files[0].name)"
                   style="display: none;"
                   type="file"
                   ngf-select ng-model="crud.spreadsheet"
                   ngf-pattern="'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'"
                   accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
                   ngf-max-size="20MB" />
          </label>
          <span class='label label-info' id="upload-file-info"></span>
          <br><br>
          <button type='sumbit' class="btn btn-primary">Submit</button>
        </form>
      </div>
    </div>

    <div>
      <table class="table">
        <thead>
          <tr>
            <th>Year</th>
            <th>Make</th>
            <th colspan="2">Harness Types</th>
            <th>Adapter Type</th>
            <th>Edit</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="vehicle in crud.vehicles" ng-include="crud.checkEdit(vehicle)">
          </tr>
          <script type="text/ng-template" id="display">
            <td>
              <label ng-bind="vehicle.year"></label>
            </td>
            <td>
              <label ng-bind="vehicle.make"></label>
            </td>
            <td>
              <label ng-bind="vehicle.harnessTypeOne"></label>
            </td>
            <td>
              <label ng-bind="vehicle.harnessTypeTwo"></label>
            </td>
            <td>
              <!-- column for adapter type -->
            </td>
            <td>
              <button type="button" class="btn btn-primary" ng-click="crud.editVehicle(vehicle)">Edit</button>
              <button class="btn btn-danger" uib-popover-template="'deletePopover'">Delete</button>
            </td>
          </script>
          <script type="text/ng-template" id="edit">
            <td>
              <label ng-bind="vehicle.year"></label>
            </td>
            <td>
              <label ng-bind="vehicle.make"></label>
            </td>
            <td>
              <input type="number" ng-model='vehicle.harnessTypeOne' class="form-control input-sm" />
            </td>
            <td>
              <input type="number" ng-model='vehicle.harnessTypeTwo' class="form-control input-sm" />
            </td>
            <td>
              <!-- column for adapter type --> 
            </td>
            <td>
              <button type="button" class="btn btn-primary" ng-click="crud.updateVehicle(vehicle)">Save</button>
              <button type="button" class="btn btn-danger" ng-click="crud.reset()">Cancel</button>
            </td>
          </script>
          <script type="text/ng-template" id="deletePopover">
            <div>
              <div class="popover-arrow"></div>
              <h3 class="popover-title">Are you sure?</h3>
              <div class="popover-content">
                <button class="btn btn-danger" ng-click="crud.deleteVehicle(vehicle)">Confirm</button>
                <button class="btn btn-primary" ng-click="crud.reset()">Stooopp!</button>
              </div>
            </div>
          </script>
        </tbody>
      </table>
    </div>
  </div>


</body>

</html>
